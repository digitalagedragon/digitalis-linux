version: 2.31
bdepend:
  - kernel/linux-headers
filename: glibc
upstream: http://ftp.gnu.org/gnu/glibc/
license: GPL-2.0-or-later AND LGPL-2.1-or-later
use_build_dir: true
additional_configure_options: --disable-werror --enable-kernel=3.2 libc_cb_slibdir=/lib
install: |
    make DESTDIR=/target_root install
    cp -v ../%{unpack_dir}/nscd/nscd.conf /target_root/etc/nscd.conf
post_install_script: |
    mkdir -pv var/cache/nscd lib64 usr/lib
    ln -sfv ld-%{version}.so lib64/ld-linux-x86-64.so.2
    ln -sfv ../lib/ld-linux-x86-64.so.2 lib64/ld-lsb-x86-64.so.3
    ln -sfv ../lib64/crt1.o usr/lib/crt1.o
    ln -sfv ../lib64/crti.o usr/lib/crti.o
    ln -sfv ../lib64/crtn.o usr/lib/crtn.o

    mkdir -p etc
    cat > etc/ld.so.conf << "EOF"
    # Begin /etc/ld.so.conf
    /usr/local/lib
    /opt/lib

    EOF
queue_hooks:
  ldconfig: true