version: "6.2"
filename: ncurses
comp: tar.gz
upstream: https://ftp.gnu.org/gnu/ncurses/
license: MIT
additional_configure_options: >
  --mandir=/usr/share/man
  --with-shared
  --without-debug
  --without-normal
  --enable-pc-files
  --enable-widec
install: |
  make DESTDIR=/target_root install
  mkdir -pv /target_root/usr/share/doc/ncurses-%{version}
  cp -v -R doc/* /target_root/usr/share/doc/ncurses-%{version}
post_install_script: |
    mkdir -p lib usr/lib/pkgconfig
    mv -v usr/lib/libncursesw.so.6* lib
    ln -sfv ../../lib/$(readlink usr/lib/libncursesw.so) usr/lib/libncursesw.so

    for lib in ncurses form panel menu ; do
        rm -vf                    usr/lib/lib${lib}.so
        echo "INPUT(-l${lib}w)" > usr/lib/lib${lib}.so
        ln -sfv ${lib}w.pc        usr/lib/pkgconfig/${lib}.pc
    done

    rm -vf                     usr/lib/libcursesw.so
    echo "INPUT(-lncursesw)" > usr/lib/libcursesw.so
    ln -sfv libncurses.so      usr/lib/libcurses.so
queue_hooks:
  ldconfig: true