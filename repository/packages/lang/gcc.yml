version: 9.3.0
bdepend:
  - libs/gmp
  - libs/mpc
  - libs/mpfr
  - libs/zlib
  - util/diffutils
rdepend:
  - libs/gmp
  - libs/mpc
  - libs/mpfr
  - libs/zlib
filename: gcc
upstream: http://ftp.gnu.org/gnu/gcc/gcc-%{version}/
license: GFD-1.2-or-later AND GPL-3.0-or-later AND LGPL-2.1-or-later
license_location: spdx
additional_configure_options: --enable-languages=c,c++ --disable-multilib --disable-bootstrap --with-system-zlib
pre_configure_script: |
  sed -e '/m64=/s/lib64/lib/' -i.orig ../%{unpack_dir}/gcc/config/i386/t-linux64
  pushd ../%{unpack_dir}
  cat gcc/limitx.h gcc/glimits.h gcc/limity.h > \
    `dirname $($(gcc -dumpmachine)-gcc -print-libgcc-file-name)`/include-fixed/limits.h
make_options: -j16
post_install_script: |
  mkdir -p lib
  ln -sv ../usr/bin/cpp lib/
  ln -sv gcc usr/bin/cc
  install -v -dm755 usr/lib/bfd-plugins
  ln -sfv ../../libexec/gcc/$(gcc -dumpmachine)/$VERSION/liblto_plugin.so \
      usr/lib/bfd-plugins/
  rm -rf usr/lib/gcc/$(gcc -dumpmachine)/$VERSION/include-fixed/bits/
  mkdir -pv usr/share/gdb/auto-load/usr/lib
  mv -v usr/lib/*gdb.py usr/share/gdb/auto-load/usr/lib
use_build_dir: true
