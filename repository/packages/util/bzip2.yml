version: "1.0.8"
bdepend:
  - util/diffutils
filename: bzip2
comp: tar.gz
upstream: https://www.sourceware.org/pub/bzip2/
license: bzip2-1.0.6
configure: ~
pre_configure_script: |
    sed -i 's@\(ln -s -f \)$(PREFIX)/bin/@\1@' Makefile
    sed -i "s@(PREFIX)/man@(PREFIX)/share/man@g" Makefile
    make -f Makefile-libbz2_so $MAKEOPTS
    make clean
install: |
  make install PREFIX=/target_root/usr
  mkdir -p /target_root/usr/lib /target_root/{bin,lib}
  cp bzip2-shared /target_root/bin/bzip2
  cp -av libbz2.so* /target_root/lib
post_install_script: |
  ln -sv ../../lib/libbz2.so.1.0 usr/lib/libbz2.so
  rm -v usr/bin/{bunzip2,bzcat,bzip2}
  ln -sv bzip2 bin/bunzip2
  ln -sv bzip2 bin/bzcat
queue_hooks:
  ldconfig: true